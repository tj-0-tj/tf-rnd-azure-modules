parameters:
    - name : PERSONS 
      type: object
      default: null
steps:
  - ${{ each item in parameters.PERSONS }}:
     - script: echo '${{ item.name }}=${{ replace(convertToJson(item.age), ':', '=')}}' >> parameters.auto.tfvars
       displayName: "JsonVar ${{ item.name }}"

  - task: Bash@3
    displayName: "Test"
    inputs:
      targetType: inline
      script: |
        cat parameters.auto.tfvars
        echo "${{ convertToJson(parameters.PERSONS) }}"
        env
    env:
      ${{ each item in parameters.PERSONS }}:
        ${{ format('TJ_VARS_{0}', item.index) }}: ${{ item.name }}
            
        
